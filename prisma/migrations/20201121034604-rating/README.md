# Migration `20201121034604-rating`

This migration has been generated by Eli Sokeland at 11/20/2020, 10:46:04 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "rating-project"."Category" AS ENUM ('FRONTEND', 'BACKEND')

CREATE TABLE "rating-project"."Rating" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"reviewerID" text   NOT NULL ,
"reviewedID" text   NOT NULL ,
"category" "Category"  NOT NULL ,
"rating" integer   NOT NULL ,
"notes" text   ,
"userId" text   ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Rating_reviewerID_unique" ON "rating-project"."Rating"("reviewerID")

CREATE UNIQUE INDEX "Rating_reviewedID_unique" ON "rating-project"."Rating"("reviewedID")

ALTER TABLE "rating-project"."Rating" ADD FOREIGN KEY ("reviewerID")REFERENCES "rating-project"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "rating-project"."Rating" ADD FOREIGN KEY ("reviewedID")REFERENCES "rating-project"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "rating-project"."Rating" ADD FOREIGN KEY ("userId")REFERENCES "rating-project"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201113211310-initial-migration..20201121034604-rating
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -20,10 +20,31 @@
   password  String
   firstname String?
   lastname  String?
   role      Role
+  ratings   Rating[]
+  reviewer  Rating @relation("reviewer")
+  reviewed  Rating @relation("reviewed")
 }
 enum Role {
   ADMIN
   USER
 }
+
+model Rating {
+  id          String   @id @default(cuid())
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+  reviewer    User     @relation("reviewer", fields: [reviewerID], references: [id])
+  reviewerID  String
+  reviewed    User     @relation("reviewed", fields: [reviewedID], references: [id])
+  reviewedID  String
+  category    Category
+  rating      Int
+  notes       String?
+}
+
+enum Category {
+  FRONTEND
+  BACKEND
+}
```


